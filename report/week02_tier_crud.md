# 3계층 구조(3-Tier Architecture)와 CRUD 작동 흐름

이 문서는 현대적인 소프트웨어 아키텍처의 기반이 되는 **3계층 구조(3-Tier Architecture)**를 이해하고, 데이터 처리의 기본인 **CRUD**가 웹 애플리케이션에서 어떻게 작동하는지 그 흐름을 설명합니다.

---

## 1. 3계층 구조 (3-Tier Architecture)

3계층 구조는 소프트웨어 애플리케이션의 기능을 **프레젠테이션(Presentation)**, **애플리케이션(Application)**, **데이터(Data)**라는 세 개의 논리적 및 물리적 계층으로 분리하는 아키텍처 패턴입니다. 각 계층은 독립적인 역할을 수행하며, 이를 통해 시스템의 **유연성**, **확장성**, **재사용성**, **유지보수성**을 높일 수 있습니다.

### ### 1) 프레젠테이션 계층 (Presentation Tier / Client Tier)
-   **역할**: 사용자에게 직접 보이는 부분으로, UI/UX를 담당합니다. 사용자의 입력을 받고, 처리 결과를 시각적으로 표시합니다.
-   **주요 기술**: HTML, CSS, JavaScript 및 React, Vue, Angular와 같은 프레임워크.
-   **책임**:
    -   사용자 인터페이스(UI) 제공.
    -   사용자로부터 데이터 입력(HTTP Request 생성).
    -   애플리케이션 계층에서 받은 데이터를 사용자에게 표시.
-   **환경**: 웹 브라우저, 모바일 앱 등.

### ### 2) 애플리케이션 계층 (Application Tier / Business Logic / Middle Tier)
-   **역할**: 시스템의 핵심 비즈니스 로직을 처리합니다. 프레젠테이션 계층의 요청을 받아 데이터를 가공하고, 데이터 계층에 필요한 작업을 지시합니다.
-   **주요 기술**: Java(Spring), Python(Django), Node.js(Express), C#(.NET) 등 서버 사이드 언어 및 프레임워크.
-   **책임**:
    -   프레젠테이션 계층으로부터의 요청 처리.
    -   데이터 유효성 검사, 계산, 가공 등 **비즈니스 로직 수행**.
    -   데이터 계층과 통신하여 데이터 CRUD 작업 지시.
    -   트랜잭션 관리, 인증/인가 처리.
-   **환경**: 웹 애플리케이션 서버(WAS).

### ### 3) 데이터 계층 (Data Tier / Data Access Tier)
-   **역할**: 데이터의 저장, 조회, 수정, 삭제를 전담합니다. 데이터베이스 시스템이 이 계층에 해당됩니다.
-   **주요 기술**: MySQL, PostgreSQL, Oracle (관계형 DB), MongoDB, Redis (NoSQL DB).
-   **책임**:
    -   애플리케이션 계층의 요청에 따라 데이터를 영구적으로 저장(Persistence).
    -   데이터 검색, 생성, 수정, 삭제 수행.
    -   데이터의 일관성과 무결성 유지.
-   **환경**: 데이터베이스 서버.

### ### 3계층 구조의 장점

-   **독립적인 개발**: 각 계층을 다른 팀이 독립적으로 개발하고 테스트할 수 있습니다.
-   **향상된 확장성**: 특정 계층에 부하가 집중될 경우 해당 계층만 확장(Scale-out)할 수 있습니다. 예를 들어, 사용자가 많아지면 웹 서버만 증설할 수 있습니다.
-   **유연한 기술 변경**: UI 기술이 바뀌어도 비즈니스 로직이나 데이터베이스는 그대로 유지할 수 있습니다.

---

## 2. CRUD 개념과 웹 흐름

**CRUD**는 대부분의 컴퓨터 소프트웨어가 가지는 기본적인 데이터 처리 기능인 **Create(생성)**, **Read(읽기)**, **Update(수정)**, **Delete(삭제)**를 묶어서 일컫는 말입니다.

### ### CRUD와 HTTP 메서드 매핑

웹 애플리케이션에서 CRUD 작업은 주로 **HTTP 프로토콜의 메서드**와 다음과 같이 매핑됩니다.

| CRUD 작업 | HTTP 메서드   | 설명                                                   |
|-----------|---------------|--------------------------------------------------------|
| **C**reate  | `POST`        | 새로운 데이터를 **생성**합니다. (예: 게시글 작성, 회원 가입) |
| **R**ead    | `GET`         | 데이터를 **조회**합니다. (예: 게시글 목록 보기, 특정 게시글 읽기) |
| **U**pdate  | `PUT` / `PATCH` | 기존 데이터를 **수정**합니다. (예: 게시글 수정, 내 정보 변경) |
| **D**elete  | `DELETE`      | 기존 데이터를 **삭제**합니다. (예: 게시글 삭제, 회원 탈퇴) |

* `PUT`: 리소스 전체를 교체.
* `PATCH`: 리소스의 일부만 수정.

### ### CRUD 작동 흐름 예시 (게시글 작성 및 조회)

#### 📝 **Create (생성): 사용자가 새 게시글을 작성하는 흐름**

1.  **프레젠테이션 계층 (Client)**
    -   사용자가 웹 브라우저에서 '글쓰기' 버튼을 클릭합니다.
    -   제목과 내용을 입력하고 '저장' 버튼을 누릅니다.
    -   JavaScript는 입력된 데이터를 포함하여 `POST /posts` HTTP 요청을 생성하여 서버로 전송합니다.

2.  **애플리케이션 계층 (Server)**
    -   서버(WAS)는 `POST /posts` 요청을 받아 해당 로직을 처리할 컨트롤러(Controller)에게 전달합니다.
    -   컨트롤러는 서비스(Service) 객체에 데이터 처리를 위임합니다.
    -   서비스는 입력 데이터의 유효성을 검사(Validation)하고, 비즈니스 로직(예: 금지어 필터링)을 수행한 후, 데이터를 데이터베이스에 저장하도록 데이터 계층에 요청합니다.

3.  **데이터 계층 (Database)**
    -   서버로부터 받은 데이터를 `INSERT` 쿼리를 실행하여 데이터베이스의 `posts` 테이블에 새로운 레코드를 추가합니다.
    -   처리 결과를 애플리케이션 계층에 반환합니다.

4.  **응답 흐름**
    -   애플리케이션 계층은 데이터 저장이 성공했다는 응답(예: `201 Created` 상태 코드)을 프레젠테이션 계층으로 보냅니다.
    -   클라이언트는 "저장이 완료되었습니다" 라는 메시지를 사용자에게 보여주거나, 방금 생성된 게시글 상세 페이지로 이동(Redirect)시킵니다.

#### 📖 **Read (조회): 사용자가 게시글 목록을 보는 흐름**

1.  **프레젠테이션 계층 (Client)**
    -   사용자가 '게시판' 메뉴를 클릭합니다.
    -   웹 브라우저는 게시글 목록을 요청하는 `GET /posts` HTTP 요청을 서버로 전송합니다.

2.  **애플리케이션 계층 (Server)**
    -   서버는 `GET /posts` 요청을 받아 해당 컨트롤러에게 전달합니다.
    -   컨트롤러는 서비스 객체에게 게시글 목록 조회를 요청합니다.
    -   서비스는 데이터 계층에 게시글 목록을 가져오도록 지시합니다.

3.  **데이터 계층 (Database)**
    -   `SELECT * FROM posts ORDER BY created_at DESC`와 같은 쿼리를 실행하여 `posts` 테이블에서 데이터를 조회합니다.
    -   조회된 데이터 목록을 애플리케이션 계층에 반환합니다.

4.  **응답 흐름**
    -   애플리케이션 계층은 데이터베이스로부터 받은 데이터 목록을 JSON 또는 다른 포맷으로 가공합니다.
    -   가공된 데이터를 HTTP 응답에 담아 프레젠테이션 계층으로 전송합니다.
    -   클라이언트는 받은 데이터를 사용하여 HTML을 동적으로 생성하고, 사용자에게 게시글 목록을 화면에 렌더링하여 보여줍니다.
